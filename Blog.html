<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yi Zhu" />


<title>Blog about ggplot2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Blog.html">Blog</a>
</li>
<li>
  <a href="http://www.baige.me/v?i=SVT">Resume</a>
</li>
<li>
  <a href="http://www.baige.me/v?i=SVg">Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:&lt;yiz4003@med.cornell.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/curryz427/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/YiZhu60259370">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/yi-zhu-a564a2195/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Blog about ggplot2</h1>
<h4 class="author">Yi Zhu</h4>

</div>


<div id="ggplot2" class="section level1">
<h1>ggplot2</h1>
<p>This blog aims at introducing the “ggplot2” package and showing the power using “ggplot2” to achieve visualization. As John Tukey says, “The greatest value of a picture is when it forces us to notice what we never expected to see.”. In this blog, I will show you how to use “ggplot2” to make pictures and how to interpret the pictures.</p>
<p>In this blog, I use NHANES data — "“nhgh.tsv”, which is downloaded from <a href="http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets" class="uri">http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets</a>, to show visualization and interpretation.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages -------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## √ ggplot2 3.2.1     √ purrr   0.3.2
## √ tibble  2.1.3     √ dplyr   0.8.3
## √ tidyr   0.8.3     √ stringr 1.4.0
## √ readr   1.3.1     √ forcats 0.4.0</code></pre>
<pre><code>## -- Conflicts ----------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(ggplot2)</code></pre>
<pre class="r"><code>data &lt;- read_tsv(&quot;nhgh.tsv&quot;) # load the data</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   sex = col_character(),
##   re = col_character(),
##   income = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>names(data) # get variables of data</code></pre>
<pre><code>##  [1] &quot;seqn&quot;    &quot;sex&quot;     &quot;age&quot;     &quot;re&quot;      &quot;income&quot;  &quot;tx&quot;      &quot;dx&quot;     
##  [8] &quot;wt&quot;      &quot;ht&quot;      &quot;bmi&quot;     &quot;leg&quot;     &quot;arml&quot;    &quot;armc&quot;    &quot;waist&quot;  
## [15] &quot;tri&quot;     &quot;sub&quot;     &quot;gh&quot;      &quot;albumin&quot; &quot;bun&quot;     &quot;SCr&quot;</code></pre>
<p>Meaning of the variables: seqn: individual’s sequence number; sex: sex of individuals; age: age of individuals; re: race/ethnicity of individuals; income: income of individuals; tx: insulin use of individuals; wt: weight of individuals; ht: height of individuals; bmi: BMI level of individuals; leg, arml, armc, waist, tri, sub: measured data of individuals; gh: gylcohemoglobin levele of individuals; albumin: albumin level of individuals; bun: blood urea nitrogen level of individuals; SCr: Scr level of individuals.</p>
<div id="histogram" class="section level2">
<h2>Histogram</h2>
<p>Histogram is a powerful visualization tool. It is an accurate representation of the distribution of numerical data. It shows the probability of a variable. The shape or the pattern of the histogram can be “symmetric”, “skewed left” or “right”, “unimodal”, “bimodal” or “multimodal”.</p>
<p>Now, let us use ggplot2 to make a histogram of the data. We will use “geom_histogram” to make the plot. In this part, we will use variable “ht”, which represents the heights of individuals.</p>
<pre class="r"><code>data %&gt;% # use data
  ggplot(aes(x = ht)) + 
  geom_histogram(binwidth = 1.5, color = &quot;darkblue&quot;, fill = &quot;lightblue&quot;) + # plot the histogram
  labs(title = &quot;Distribution of Height: Histogram&quot;) + 
  xlab(&quot;height&quot;) # change lab and title</code></pre>
<p><img src="Blog_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>From this histogram, we can see that it is relatively symmetric. And the height range of this data is [120, 200]. Height of 165cm hs the most count number.</p>
<p>Now, we make some changes to the histogram, to show the distribution of height by sex.</p>
<pre class="r"><code>data %&gt;% # use data
  ggplot(aes(x = ht, color = sex, fill = sex)) + 
  geom_histogram(binwidth = 1.5, alpha = 0.5, position = &quot;identity&quot;) +  # plot the histogram by sex
  labs(title = &quot;Distributions of Female and Male Heights: Histogram&quot;) + 
  xlab(&quot;height&quot;) # change lab and title</code></pre>
<p><img src="Blog_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>From this histogram, we can see the distribution of height for female (pink) and male (blue). From this histogram, we can make comparisons. The heights of females are generally smaller than the heights of males. The heights of females appears centered around 160. The heights of males appears to be centered around 173. The distribution of male heights appears to have more variability (spread) than that of females.</p>
<p>Thus, we can see that histogram can used to analyse the distrbution of a variable. But how about analysing the relationship between more than one variables? We can use scatterplot!</p>
</div>
<div id="scatterplot" class="section level2">
<h2>Scatterplot</h2>
<p>Scatterplot is a type of plot or mathematical diagram using Cartesian coordinates to display values for typically two variables for a set of data. Also, we can change the points’ color/shape/size to compare more vaiables. Each point in the scatterplot contains the information of many variables. This is a useful plot to gain information.</p>
<p>Now, let us use “geom_point”, to make a scatterplot of gylcohemoglobin versus BMI.</p>
<pre class="r"><code>data %&gt;% # use data
  ggplot(aes(x = gh, y = bmi)) + 
  geom_point(pch = 20) + # make the sactterplot of gylcohemoglobin versus BMI
  labs(title = &quot;Gylcohemoglobin and BMI&quot;, 
       x = &quot;Gylcohemoglobin&quot;, 
       y = &quot;BMI&quot;) #change labs and title</code></pre>
<p><img src="Blog_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>In this scatterplot, we can see different individuals’ gylcohemoglobin level and BMI. Most points lie in the lower left corner, which means they have relatively low level of gylcohemoglobin and BMI. But it seems the comparison is not so clear. So, we decide to use color of points to strengthen the effect of contrast.</p>
<p>Now, we use make a scatterplot of gylcohemoglobin versus BMI colored by insulin use.</p>
<pre class="r"><code>data %&gt;% # use data
  mutate(tx = fct_recode(factor(tx), `No insulin` = &quot;0&quot;, Insulin = &quot;1&quot;)) %&gt;% # redefine tx (the insulin use)
  ggplot(aes(x = gh, y = bmi, col = tx)) + 
  geom_point(pch = 20) + # make the scatterplot of gylcohemoglobin versus BMI colored by insulin use
  labs(title = &quot;Gylcohemoglobin and BMI by insulin use&quot;, 
       x = &quot;Gylcohemoglobin&quot;, 
       y = &quot;BMI&quot;, 
       col = &quot;Insulin use&quot;) # change labs and title</code></pre>
<p><img src="Blog_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>From the sactterplot, we can see that individuals who use insulin have higher gylcohemoglobin values and higher variability than those with no insulin at the same levels of BMI. There are a few outliers in the plot (i.e. some individuals have abnormally high BMI values and low gylcohemoglobin). The is a right skew in gylcohemoglobin distribution and it is mostly due to individuals who are taking insulin. However, not all individuals who are taking insulin have high levels of gylcohemoglobin.</p>
</div>
<div id="bar-chart" class="section level2">
<h2>Bar chart</h2>
<p>After introducing histogram and scatterplot, we want to talk about making barplot, which is also an effective tool for us to analyse data. bar chart presents categorical data with rectangular bars with heights or lengths proportional to the values that they represent. It shows comparisons among discrete categories.</p>
<p>Now, let us make a bar chart showing the BMI composition in each race/ethnicity. The BMI groups are defined as follows: normal (BMI ≤ 25), overweight (25 &lt; BMI ≤ 30), and obese (BMI &gt; 30).</p>
<pre class="r"><code>data %&gt;% # use data
  mutate(bmicat = ifelse(bmi &lt;= 25, &quot;normal&quot;, ifelse(bmi &gt; 30, &quot;obese&quot;, &quot;overweight&quot;))) %&gt;% # create new variable to show BMI level
  ggplot(aes(str_wrap(re, 10), fill = bmicat)) + 
  geom_bar(stat = &quot;count&quot;) + # make bar chart of the BMI composition in each race/ethnicity
  labs(title = &quot;BMI composition by race&quot;, 
       x = &quot;Race&quot;, 
       y = &quot;Proportion of patients&quot;, 
       fill = &quot;BMI&quot;) # change labs and title</code></pre>
<p><img src="Blog_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>From this bar chart, we can see that the BMI distribution is different across racial groups. Among Mexican Americans, there are more obese and more overweight patients than patients with normal BMI. Among non-hispanic black patients, the number of obese patients are greater than the number of normal BMI patients. For other hispanic patients, the distribution of normal, obese, and overweight patients are quite similar. For other race including multi-racial patients, there are more patients with normal BMI than obese or overweight patients.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>From this blog, we hope you can find the power of ggplot2 and study some techniques to help you interpret the data. GGplot2 is really a useful tool and we still need to explore it.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
